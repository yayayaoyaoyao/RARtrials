# }
# if (deltaa!=0){
#  posteriorp1<-do.call(cbind,posteriorp)
# }
pii<-as.data.frame(do.call(cbind,aloo))
colnames(pii)<-armleft
# if (jjj<N2){
#   sim111<-do.call(cbind,result)
#   colnames(sim111)<-armleft
#   #  simout[jjj,]<-sim111
# } else if (jjj==N2) {
#   sim111t<-do.call(cbind,resultt)
#   colnames(sim111t)<-armleft
#   #  simout[jjj,]<-sim111t
# }
pii<-pii[ , order(names(pii))]
if (pii[,1]>pii[,2]){
pii<-c(1,0)
}else{
pii<-c(0,1)
}
armleft<-sort(armleft,decreasing = FALSE)
# if ( jjj<N2){
#   for (k in 2:length(armleft)) {
#     if (sim111[1,k]<0.01 & is.na(decision[armleft[k]]) ){#decision[armleft[k]] %in% NA
#       decision[armleft[k]]<-'Futility'
#       stopp[armleft[k]]<-jjj
#       if (deltaa==0){
#         phi[armleft[k]]<-sim111[1,k]
#       }else if (deltaa!=0){
#         phi[armleft[k]]<-posteriorp1[1,k]
#       }
#     }
#   }
#
#   if ( 'Futility' %in% decision ){
#     armleft<-armleft[! armleft %in%  which (decision %in%  'Futility')]
#     # pii<- select(pii,sprintf("%s",armleft))
#     pii<- pii[,sprintf("%s",armleft)]
#   }
#
#   if((length(armleft)==1 & length( which (decision %in%  'Futility'))==(armn-1))){
#     stopp[ which (is.na(decision))]<-jjj#decision %in%  NA
#     data11<-data1[1:jjj,]
#     if (is.na(decision[1])) {#decision[1] %in% NA
#       decision[1]<-'Control Selected'
#       if (deltaa==0){
#         phi[1]<-sim111[1,1]
#       }else if (deltaa!=0){
#         phi[1]<-posteriorp1[1,1]
#       }
#     }
#
#     final[,3]<-1:total
#     return(final)
#    # return(list(data11[,4],data11[,5],decision,jjj,data11,stopp,phi))
#     break
#   }
#
#   # for (yy in 1:length(armleft)){
#   #   if ( pii[colnames(pii) %in%  armleft[yy]]<0.1){
#   #     pii[colnames(pii) %in%  armleft[yy]]=0.1
#   #   }else if ( pii[colnames(pii) %in%  armleft[yy]]>0.9){
#   #     pii[colnames(pii) %in%  armleft[yy]]=0.9
#   #   }
#   # }
#   #
#   #
#   # if (tpp==1){
#   #   pii<-(pii^(jjj/(2*N2)))^tp
#   # }else if (tpp==0){
#   #   pii<-pii^tp
#   # }
#   # pii<-pii/sum(pii)
#    pii<-pii[ , order(names(pii))]
#   if (pii[,1]>pii[,2]){
#     pii<-c(1,0)
#   }else{
#     pii<-c(0,1)
#   }
#   armleft<-sort(armleft,decreasing = FALSE)
#
# }else if (jjj==N2){
#
#
#   for (k in 2:length(armleft)) {
#     if (sim111t[1,k]>au & is.na(decision[armleft[k]])){ #decision[armleft[k]] %in% NA
#       decision[armleft[k]]<-'Superiorityfinal'
#       stopp[armleft[k]]<-jjj
#
#       if (deltaa==0){
#         phi[armleft[k]]<-sim111t[1,k]
#       }else if (deltaa!=0){
#         phi[armleft[k]]<-posteriorp1[1,k]
#       }
#     }
#     if (is.na(decision[armleft[k]] )) {#decision[armleft[k]] %in% NA
#
#       decision[armleft[k]]<-'Not Selected'
#       stopp[armleft[k]]<-jjj
#       if (deltaa==0){
#         phi[armleft[k]]<-sim111t[1,k]
#       }else if (deltaa!=0){
#         phi[armleft[k]]<-posteriorp1[1,k]
#       }
#     }
#   }
#   if (length( which (decision %in%  'Futility'))==(armn-1) &
#       is.na(decision[1])){
#     decision[1]<-'Control Selected'
#     if (deltaa==0){
#       phi[1]<-sim111t[1,1]
#     }else if (deltaa!=0){
#       phi[1]<-posteriorp1[1,1]
#     }
#   }
#
}
data11<-data1[1:N2,]
final[,3]<-1:N2
return(final)
#  return(list(data11[,4],data11[,5],decision,N2,data11,stopp,phi))
}
##################### Simulations #####################
enrollratef<-c(0.1,0.5,0.9)
perctp<-0.5
perctt1<-c(0,0.1,0.2)
perctt2<-c(0,0.1,0.2)
repn<-20
sim11<-vector("list",length(enrollratef))
for (jj in (1:length(enrollratef))){
seeds<-1:repn
sim11[[jj]]<-lapply(1:repn,function(x) {
set.seed(seeds[x])
pop(vPatsPerMonth=10,nMaxQtyPats=50000,enrollrate1=enrollratef[jj])})
}
##################
set.seed(98765)
sim1<-lapply(1:repn,function(x) {
brarfun(jj=jj,x=x,armn=2,h=c(0.6,0.7),vTimeToOutcome1=0,N2=992,N1=100,armlabel=c(1, 2),blocksize=4,
alpha1=1,beta1=1,alpha2=1,beta2=1,alpha3=1,beta3=1,alpha4=1,beta4=1,alpha5=1,beta5=1,
deltaa=0)#deltaa=-0.05,tpp=0,deltaa1=0minstart=100,
})
simf<-as.data.frame(do.call(rbind,sim1))
simff<-matrix(NA_real_,nrow = nrow(simf),ncol=3)
simff[1:nrow(simf),1]<-simf[,2]-simf[,1]
simff[1:nrow(simf),2]<-simf[,3]
# simff<-matrix(NA_real_,nrow = 2*nrow(simf),ncol=3)
#
# simff[1:nrow(simf),1]<-simf[,1]
# simff[(nrow(simf)+1):(2*nrow(simf)),1]<-simf[,2]
#
# simff[1:nrow(simf),2]<-simf[,3]
# simff[(nrow(simf)+1):(2*nrow(simf)),2]<-simf[,3]
simff<-as.data.frame(simff)
simff$V2<-as.numeric(simff$V2)
simff$V1<-as.numeric(simff$V1)
# simff$V3[1:nrow(simf)]<-1
# simff$V3[(nrow(simf)+1):(2*nrow(simf))]<-2
simff$V3[1:992]<-2
simff$V3[(992+1):(nrow(simf))]<-1
simff<-rbind(simff[(992+1):(nrow(simf)),],simff[1:992,])
simff<-na.omit(as.data.frame(simff))
plot1<-ggplot(simff) + geom_point(size=0.02,aes(x=V2,y=V1,color=factor(V3)))+ #,alpha = 0.02
scale_color_manual(values = c("grey","black")) +theme_classic()   + theme(legend.position = "none")  +
labs(title='Optimal Bayesian Allocation',x='Total Number of Participants',y=expression('n'[B]-'n'[A]))+coord_cartesian(xlim = c(0,1000),ylim=c(-1000,1000)) +
theme(plot.margin = margin(4,1.5,4,1.5, "cm"),plot.title = element_text(hjust = 0.5))
ggplot2::ggsave(filename = 'C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/22_09_13/plot/final/roc_brar/optimal_bayesian_decision.png',
plot = plot1,
dpi = 500,
width =8, height = 7, units = "in")
library(gridExtra)
library(ggplot2)
options(scipen=999)
patha="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/BRAR/two_arms_big_sim/diff_0_1/"
pathb='beta_1_1/delayed_response_0/tp_0_5'
pathc='beta_1_1/delayed_response_0/tp_1'
pathd='beta_1_1/delayed_response_0/tp_n_2N'
pathb1='beta_1_1/delayed_response_1/tp_0_5'
pathc1='beta_1_1/delayed_response_1/tp_1'
pathd1='beta_1_1/delayed_response_1/tp_n_2N'
pathb2='beta_1_1/delayed_response_2/tp_0_5'
pathc2='beta_1_1/delayed_response_2/tp_1'
pathd2='beta_1_1/delayed_response_2/tp_n_2N'
pathe='beta_2_3/delayed_response_0/tp_0_5'
pathf= 'beta_2_3/delayed_response_0/tp_1'
pathg= 'beta_2_3/delayed_response_0/tp_n_2N'
pathe1='beta_2_3/delayed_response_1/tp_0_5'
pathf1= 'beta_2_3/delayed_response_1/tp_1'
pathg1= 'beta_2_3/delayed_response_1/tp_n_2N'
pathe2='beta_2_3/delayed_response_2/tp_0_5'
pathf2= 'beta_2_3/delayed_response_2/tp_1'
pathg2= 'beta_2_3/delayed_response_2/tp_n_2N'
pathh='beta_4_6/delayed_response_0/tp_0_5'
pathi= 'beta_4_6/delayed_response_0/tp_1'
pathj= 'beta_4_6/delayed_response_0/tp_n_2N'
pathh1='beta_4_6/delayed_response_1/tp_0_5'
pathi1= 'beta_4_6/delayed_response_1/tp_1'
pathj1= 'beta_4_6/delayed_response_1/tp_n_2N'
pathh2='beta_4_6/delayed_response_2/tp_0_5'
pathi2= 'beta_4_6/delayed_response_2/tp_1'
pathj2= 'beta_4_6/delayed_response_2/tp_n_2N'
patterna='brar.*\\.csv'
files1<-list.files(paste(c(patha,pathb),collapse = ""),pattern = patterna,full.names=TRUE)
sim1<-do.call(rbind,lapply(files1,read.csv,stringsAsFactors= TRUE))
files2<-list.files(paste(c(patha,pathc),collapse = ""),pattern = patterna,full.names=TRUE)
sim2<-do.call(rbind,lapply(files2,read.csv,stringsAsFactors= TRUE))
files3<-list.files(paste(c(patha,pathd),collapse = ""),pattern = patterna,full.names=TRUE)
sim3<-do.call(rbind,lapply(files3,read.csv,stringsAsFactors= TRUE))
files4<-list.files(paste(c(patha,pathe),collapse = ""),pattern = patterna,full.names=TRUE)
sim4<-do.call(rbind,lapply(files4,read.csv,stringsAsFactors= TRUE))
files5<-list.files(paste(c(patha,pathf),collapse = ""),pattern = patterna,full.names=TRUE)
sim5<-do.call(rbind,lapply(files5,read.csv,stringsAsFactors= TRUE))
files6<-list.files(paste(c(patha,pathg),collapse = ""),pattern = patterna,full.names=TRUE)
sim6<-do.call(rbind,lapply(files6,read.csv,stringsAsFactors= TRUE))
files7<-list.files(paste(c(patha,pathh),collapse = ""),pattern = patterna,full.names=TRUE)
sim7<-do.call(rbind,lapply(files7,read.csv,stringsAsFactors= TRUE))
files8<-list.files(paste(c(patha,pathi),collapse = ""),pattern = patterna,full.names=TRUE)
sim8<-do.call(rbind,lapply(files8,read.csv,stringsAsFactors= TRUE))
files9<-list.files(paste(c(patha,pathj),collapse = ""),pattern = patterna,full.names=TRUE)
sim9<-do.call(rbind,lapply(files9,read.csv,stringsAsFactors= TRUE))
files11<-list.files(paste(c(patha,pathb1),collapse = ""),pattern = patterna,full.names=TRUE)
sim11<-do.call(rbind,lapply(files11,read.csv,stringsAsFactors= TRUE))
files21<-list.files(paste(c(patha,pathc1),collapse = ""),pattern = patterna,full.names=TRUE)
sim21<-do.call(rbind,lapply(files21,read.csv,stringsAsFactors= TRUE))
files31<-list.files(paste(c(patha,pathd1),collapse = ""),pattern = patterna,full.names=TRUE)
sim31<-do.call(rbind,lapply(files31,read.csv,stringsAsFactors= TRUE))
files12<-list.files(paste(c(patha,pathb2),collapse = ""),pattern = patterna,full.names=TRUE)
sim12<-do.call(rbind,lapply(files12,read.csv,stringsAsFactors= TRUE))
files22<-list.files(paste(c(patha,pathc2),collapse = ""),pattern = patterna,full.names=TRUE)
sim22<-do.call(rbind,lapply(files22,read.csv,stringsAsFactors= TRUE))
files32<-list.files(paste(c(patha,pathd2),collapse = ""),pattern = patterna,full.names=TRUE)
sim32<-do.call(rbind,lapply(files32,read.csv,stringsAsFactors= TRUE))
files41<-list.files(paste(c(patha,pathe1),collapse = ""),pattern = patterna,full.names=TRUE)
sim41<-do.call(rbind,lapply(files41,read.csv,stringsAsFactors= TRUE))
files51<-list.files(paste(c(patha,pathf1),collapse = ""),pattern = patterna,full.names=TRUE)
sim51<-do.call(rbind,lapply(files51,read.csv,stringsAsFactors= TRUE))
files61<-list.files(paste(c(patha,pathg1),collapse = ""),pattern = patterna,full.names=TRUE)
sim61<-do.call(rbind,lapply(files61,read.csv,stringsAsFactors= TRUE))
files42<-list.files(paste(c(patha,pathe2),collapse = ""),pattern = patterna,full.names=TRUE)
sim42<-do.call(rbind,lapply(files42,read.csv,stringsAsFactors= TRUE))
files52<-list.files(paste(c(patha,pathf2),collapse = ""),pattern = patterna,full.names=TRUE)
sim52<-do.call(rbind,lapply(files52,read.csv,stringsAsFactors= TRUE))
files62<-list.files(paste(c(patha,pathg2),collapse = ""),pattern = patterna,full.names=TRUE)
sim62<-do.call(rbind,lapply(files62,read.csv,stringsAsFactors= TRUE))
files71<-list.files(paste(c(patha,pathh1),collapse = ""),pattern = patterna,full.names=TRUE)
sim71<-do.call(rbind,lapply(files71,read.csv,stringsAsFactors= TRUE))
files81<-list.files(paste(c(patha,pathi1),collapse = ""),pattern = patterna,full.names=TRUE)
sim81<-do.call(rbind,lapply(files81,read.csv,stringsAsFactors= TRUE))
files91<-list.files(paste(c(patha,pathj1),collapse = ""),pattern = patterna,full.names=TRUE)
sim91<-do.call(rbind,lapply(files91,read.csv,stringsAsFactors= TRUE))
files72<-list.files(paste(c(patha,pathh2),collapse = ""),pattern = patterna,full.names=TRUE)
sim72<-do.call(rbind,lapply(files72,read.csv,stringsAsFactors= TRUE))
files82<-list.files(paste(c(patha,pathi2),collapse = ""),pattern = patterna,full.names=TRUE)
sim82<-do.call(rbind,lapply(files82,read.csv,stringsAsFactors= TRUE))
files92<-list.files(paste(c(patha,pathj2),collapse = ""),pattern = patterna,full.names=TRUE)
sim92<-do.call(rbind,lapply(files92,read.csv,stringsAsFactors= TRUE))
plotfun2<-function(dat1,dat2,dat3,enrollrate,path1,top1,method,delay){
subdat1a<-dat1[dat1$hypothesisn1==0.1 & dat1$hypothesisn2==0.2 & dat1$enrollrate==enrollrate &
dat1$proportion1==0.5 & dat1$proportion2==0,]
# subdat2a<-dat1[dat1$hypothesisn1==0.1 & dat1$hypothesisn2==0.3 & dat1$enrollrate==enrollrate &
#                  dat1$proportion1==0.5 & dat1$proportion2==0,]
#
# subdat3a<-dat1[dat1$hypothesisn1==0.2 & dat1$hypothesisn2==0.3 & dat1$enrollrate==enrollrate &
#                  dat1$proportion1==0.5 & dat1$proportion2==0,]
#
# subdat4a<-dat1[dat1$hypothesisn1==0.2 & dat1$hypothesisn2==0.4 & dat1$enrollrate==enrollrate &
#                  dat1$proportion1==0.5 & dat1$proportion2==0,]
#
# subdat5a<-dat1[dat1$hypothesisn1==0.2 & dat1$hypothesisn2==0.5 & dat1$enrollrate==enrollrate &
#                  dat1$proportion1==0.5 & dat1$proportion2==0,]
#
# subdat6a<-dat1[dat1$hypothesisn1==0.3 & dat1$hypothesisn2==0.4 & dat1$enrollrate==enrollrate &
#                  dat1$proportion1==0.5 & dat1$proportion2==0,]
#
# subdat7a<-dat1[dat1$hypothesisn1==0.3 & dat1$hypothesisn2==0.5 & dat1$enrollrate==enrollrate &
#                  dat1$proportion1==0.5 & dat1$proportion2==0,]
#
# subdat8a<-dat1[dat1$hypothesisn1==0.3 & dat1$hypothesisn2==0.6 & dat1$enrollrate==enrollrate &
#                  dat1$proportion1==0.5 & dat1$proportion2==0,]
subdat9a<-dat1[dat1$hypothesisn1==0.4 & dat1$hypothesisn2==0.5 & dat1$enrollrate==enrollrate &
dat1$proportion1==0.5 & dat1$proportion2==0,]
subdat19a<-dat1[dat1$hypothesisn1==0.8 & dat1$hypothesisn2==0.9 & dat1$enrollrate==enrollrate &
dat1$proportion1==0.5 & dat1$proportion2==0,]
#
# subdat1b<-dat2[dat2$hypothesisn1==0.1 & dat2$hypothesisn2==0.2 & dat2$enrollrate==enrollrate &
#                  dat2$proportion1==0.5 & dat2$proportion2==0,]
#
#
# subdat9b<-dat2[dat2$hypothesisn1==0.4 & dat2$hypothesisn2==0.5 & dat2$enrollrate==enrollrate &
#                  dat2$proportion1==0.5 & dat2$proportion2==0,]
#
#
#
# subdat19b<-dat2[dat2$hypothesisn1==0.8 & dat2$hypothesisn2==0.9 & dat2$enrollrate==enrollrate &
#                  dat2$proportion1==0.5 & dat2$proportion2==0,]
subdat1c<-dat3[dat3$hypothesisn1==0.1 & dat3$hypothesisn2==0.2 & dat3$enrollrate==enrollrate &
dat3$proportion1==0.5 & dat3$proportion2==0,]
subdat9c<-dat3[dat3$hypothesisn1==0.4 & dat3$hypothesisn2==0.5 & dat3$enrollrate==enrollrate &
dat3$proportion1==0.5 & dat3$proportion2==0,]
subdat19c<-dat3[dat3$hypothesisn1==0.8 & dat3$hypothesisn2==0.9 & dat3$enrollrate==enrollrate &
dat3$proportion1==0.5 & dat3$proportion2==0,]
pdf(file=path1)#, width=6, height=6
#  par(mfrow = c(9, 3),pty= 's')
par(mfrow = c(1, 1),pty= 's')
# par(mfrow=n2mfrow(2), mar=c(0,0,0),pty= 's')
# layout(matrix(c(1:19,0,0), 7, 3, byrow = TRUE))
if (enrollrate==0.1){
plot1<-qqplot(subdat1a$phi02, subdat1c$phi02,
# #main='Comparison of Test statistics under H0 Using Different Priors',
xlab= 'Test Statistic of Beta(1,1)',    ylab='Test Statistic of Beta(4,6)',
ylim=c(0,1),xlim=c(0,1))
abline(0,1,lty = 2,col = "blue")
plot.new()
mtext(top1, outer=TRUE,  cex=1, line=-3.5)
plot9<-qqplot(subdat9a$phi02, subdat9c$phi02,
# #main='Comparison of Test statistics under H0 Using Different Priors',
xlab= 'Test Statistic of Beta(1,1)',    ylab='Test Statistic of Beta(4,6)',
ylim=c(0,1),xlim=c(0,1))
abline(0,1,lty = 2,col = "blue")
plot.new()
mtext(top1, outer=TRUE,  cex=1, line=-3.5)
plot19<-qqplot(subdat19a$phi02, subdat19c$phi02,
# #main='Comparison of Test statistics under H0 Using Different Priors',
xlab= 'Test Statistic of Beta(1,1)',    ylab='Test Statistic of Beta(4,6)',
ylim=c(0,1),xlim=c(0,1))
abline(0,1,lty = 2,col = "blue")
plot.new()
mtext(top1, outer=TRUE,  cex=1, line=-3.5)
dev.off()
}
}
plotfun3<-function(dat1,dat2,dat3,enrollrate,path1,top1,method,delay){
subdat1a<-dat1[dat1$hypothesisn1==0.1 & dat1$hypothesisn2==0.2 & dat1$enrollrate==enrollrate &
dat1$proportion1==0.5 & dat1$proportion2==0,]
subdat9a<-dat1[dat1$hypothesisn1==0.4 & dat1$hypothesisn2==0.5 & dat1$enrollrate==enrollrate &
dat1$proportion1==0.5 & dat1$proportion2==0,]
subdat19a<-dat1[dat1$hypothesisn1==0.8 & dat1$hypothesisn2==0.9 & dat1$enrollrate==enrollrate &
dat1$proportion1==0.5 & dat1$proportion2==0,]
subdat1c<-dat3[dat3$hypothesisn1==0.1 & dat3$hypothesisn2==0.2 & dat3$enrollrate==enrollrate &
dat3$proportion1==0.5 & dat3$proportion2==0,]
subdat9c<-dat3[dat3$hypothesisn1==0.4 & dat3$hypothesisn2==0.5 & dat3$enrollrate==enrollrate &
dat3$proportion1==0.5 & dat3$proportion2==0,]
subdat19c<-dat3[dat3$hypothesisn1==0.8 & dat3$hypothesisn2==0.9 & dat3$enrollrate==enrollrate &
dat3$proportion1==0.5 & dat3$proportion2==0,]
pdf(file=path1)
par(mfrow = c(1, 1),pty= 's')
if ((enrollrate==0.5 & delay==60) | (enrollrate==0.9 & delay==30) ){
plot1<-qqplot(subdat1a$phi02, subdat1c$phi02,
# #main='Comparison of Test statistics under H0 Using Different Priors',
xlab= 'Test Statistic of Beta(1,1)',    ylab='Test Statistic of Beta(4,6)',
ylim=c(0,1),xlim=c(0,1))
abline(0,1,lty = 2,col = "blue")
plot.new()
mtext(top1, outer=TRUE,  cex=1, line=-3.5)
plot9<-qqplot(subdat9a$phi02, subdat9c$phi02,
# #main='Comparison of Test statistics under H0 Using Different Priors',
xlab= 'Test Statistic of Beta(1,1)',    ylab='Test Statistic of Beta(4,6)',
ylim=c(0,1),xlim=c(0,1))
abline(0,1,lty = 2,col = "blue")
plot.new()
mtext(top1, outer=TRUE,  cex=1, line=-3.5)
plot19<-qqplot(subdat19a$phi02, subdat19c$phi02,
# #main='Comparison of Test statistics under H0 Using Different Priors',
xlab= 'Test Statistic of Beta(1,1)',    ylab='Test Statistic of Beta(4,6)',
ylim=c(0,1),xlim=c(0,1))
abline(0,1,lty = 2,col = "blue")
plot.new()
mtext(top1, outer=TRUE,  cex=1, line=-3.5)
dev.off()
}
}
plotfun2(dat1=sim2,dat2=sim5,dat3=sim8,enrollrate=0.1,delay=0,
path1="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/22_09_13/plot/final/roc_brar/BRAR_tp_1_no_delayqq.pdf",
top1='Q-Q plot of Test Statistics Using BRAR with No Delay and tp=1 \nUnder the Null Hypothesis to Observe 0.1 Improvement')
plotfun2(dat1=sim3,dat2=sim6,dat3=sim9,enrollrate=0.1,delay=0,
path1="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/22_09_13/plot/final/roc_brar/BRAR_tp_n_2N_no_delayqq.pdf",
top1='Q-Q plot of Test Statistics Using BRAR with No Delay and tp=n/2N \nUnder the Null Hypothesis to Observe 0.1 Improvement')
plotfun3(dat1=sim21,dat2=sim51,dat3=sim81,enrollrate=0.9,delay=30,
path1="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/22_09_13/plot/final/roc_brar/BRAR_tp_1_1_month_delayqq0.9.pdf",
top1='Q-Q plot of Test Statistics Using BRAR with One Month Delay, tp=1 and ER=0.9 \nUnder the Null Hypothesis to Observe 0.1 Improvement')
plotfun3(dat1=sim31,dat2=sim61,dat3=sim91,enrollrate=0.9,delay=30,
path1="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/22_09_13/plot/final/roc_brar/BRAR_tp_n_2N_1_month_delayqq0.9.pdf",
top1='Q-Q plot of Test Statistics Using BRAR with One Month Delay, tp=n/2N and ER=0.9 \nUnder the Null Hypothesis to Observe 0.1 Improvement')
library(gridExtra)
library(ggplot2)
options(scipen=999)
patha="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/BRAR/two_arms_big_sim/diff_0/"
pathb='beta_1_1/delayed_response_0/tp_0_5'
pathc='beta_1_1/delayed_response_0/tp_1'
pathd='beta_1_1/delayed_response_0/tp_n_2N'
pathb1='beta_1_1/delayed_response_1/tp_0_5'
pathc1='beta_1_1/delayed_response_1/tp_1'
pathd1='beta_1_1/delayed_response_1/tp_n_2N'
pathb2='beta_1_1/delayed_response_2/tp_0_5'
pathc2='beta_1_1/delayed_response_2/tp_1'
pathd2='beta_1_1/delayed_response_2/tp_n_2N'
pathe='beta_2_3/delayed_response_0/tp_0_5'
pathf= 'beta_2_3/delayed_response_0/tp_1'
pathg= 'beta_2_3/delayed_response_0/tp_n_2N'
pathe1='beta_2_3/delayed_response_1/tp_0_5'
pathf1= 'beta_2_3/delayed_response_1/tp_1'
pathg1= 'beta_2_3/delayed_response_1/tp_n_2N'
pathe2='beta_2_3/delayed_response_2/tp_0_5'
pathf2= 'beta_2_3/delayed_response_2/tp_1'
pathg2= 'beta_2_3/delayed_response_2/tp_n_2N'
pathh='beta_4_6/delayed_response_0/tp_0_5'
pathi= 'beta_4_6/delayed_response_0/tp_1'
pathj= 'beta_4_6/delayed_response_0/tp_n_2N'
pathh1='beta_4_6/delayed_response_1/tp_0_5'
pathi1= 'beta_4_6/delayed_response_1/tp_1'
pathj1= 'beta_4_6/delayed_response_1/tp_n_2N'
pathh2='beta_4_6/delayed_response_2/tp_0_5'
pathi2= 'beta_4_6/delayed_response_2/tp_1'
pathj2= 'beta_4_6/delayed_response_2/tp_n_2N'
patterna='brar.*\\.csv'
files1<-list.files(paste(c(patha,pathb),collapse = ""),pattern = patterna,full.names=TRUE)
sim1<-do.call(rbind,lapply(files1,read.csv,stringsAsFactors= TRUE))
files2<-list.files(paste(c(patha,pathc),collapse = ""),pattern = patterna,full.names=TRUE)
sim2<-do.call(rbind,lapply(files2,read.csv,stringsAsFactors= TRUE))
files3<-list.files(paste(c(patha,pathd),collapse = ""),pattern = patterna,full.names=TRUE)
sim3<-do.call(rbind,lapply(files3,read.csv,stringsAsFactors= TRUE))
files4<-list.files(paste(c(patha,pathe),collapse = ""),pattern = patterna,full.names=TRUE)
sim4<-do.call(rbind,lapply(files4,read.csv,stringsAsFactors= TRUE))
files5<-list.files(paste(c(patha,pathf),collapse = ""),pattern = patterna,full.names=TRUE)
sim5<-do.call(rbind,lapply(files5,read.csv,stringsAsFactors= TRUE))
files6<-list.files(paste(c(patha,pathg),collapse = ""),pattern = patterna,full.names=TRUE)
sim6<-do.call(rbind,lapply(files6,read.csv,stringsAsFactors= TRUE))
files7<-list.files(paste(c(patha,pathh),collapse = ""),pattern = patterna,full.names=TRUE)
sim7<-do.call(rbind,lapply(files7,read.csv,stringsAsFactors= TRUE))
files8<-list.files(paste(c(patha,pathi),collapse = ""),pattern = patterna,full.names=TRUE)
sim8<-do.call(rbind,lapply(files8,read.csv,stringsAsFactors= TRUE))
files9<-list.files(paste(c(patha,pathj),collapse = ""),pattern = patterna,full.names=TRUE)
sim9<-do.call(rbind,lapply(files9,read.csv,stringsAsFactors= TRUE))
files11<-list.files(paste(c(patha,pathb1),collapse = ""),pattern = patterna,full.names=TRUE)
sim11<-do.call(rbind,lapply(files11,read.csv,stringsAsFactors= TRUE))
files21<-list.files(paste(c(patha,pathc1),collapse = ""),pattern = patterna,full.names=TRUE)
sim21<-do.call(rbind,lapply(files21,read.csv,stringsAsFactors= TRUE))
files31<-list.files(paste(c(patha,pathd1),collapse = ""),pattern = patterna,full.names=TRUE)
sim31<-do.call(rbind,lapply(files31,read.csv,stringsAsFactors= TRUE))
files12<-list.files(paste(c(patha,pathb2),collapse = ""),pattern = patterna,full.names=TRUE)
sim12<-do.call(rbind,lapply(files12,read.csv,stringsAsFactors= TRUE))
files22<-list.files(paste(c(patha,pathc2),collapse = ""),pattern = patterna,full.names=TRUE)
sim22<-do.call(rbind,lapply(files22,read.csv,stringsAsFactors= TRUE))
files32<-list.files(paste(c(patha,pathd2),collapse = ""),pattern = patterna,full.names=TRUE)
sim32<-do.call(rbind,lapply(files32,read.csv,stringsAsFactors= TRUE))
files41<-list.files(paste(c(patha,pathe1),collapse = ""),pattern = patterna,full.names=TRUE)
sim41<-do.call(rbind,lapply(files41,read.csv,stringsAsFactors= TRUE))
files51<-list.files(paste(c(patha,pathf1),collapse = ""),pattern = patterna,full.names=TRUE)
sim51<-do.call(rbind,lapply(files51,read.csv,stringsAsFactors= TRUE))
files61<-list.files(paste(c(patha,pathg1),collapse = ""),pattern = patterna,full.names=TRUE)
sim61<-do.call(rbind,lapply(files61,read.csv,stringsAsFactors= TRUE))
files42<-list.files(paste(c(patha,pathe2),collapse = ""),pattern = patterna,full.names=TRUE)
sim42<-do.call(rbind,lapply(files42,read.csv,stringsAsFactors= TRUE))
files52<-list.files(paste(c(patha,pathf2),collapse = ""),pattern = patterna,full.names=TRUE)
sim52<-do.call(rbind,lapply(files52,read.csv,stringsAsFactors= TRUE))
files62<-list.files(paste(c(patha,pathg2),collapse = ""),pattern = patterna,full.names=TRUE)
sim62<-do.call(rbind,lapply(files62,read.csv,stringsAsFactors= TRUE))
files71<-list.files(paste(c(patha,pathh1),collapse = ""),pattern = patterna,full.names=TRUE)
sim71<-do.call(rbind,lapply(files71,read.csv,stringsAsFactors= TRUE))
files81<-list.files(paste(c(patha,pathi1),collapse = ""),pattern = patterna,full.names=TRUE)
sim81<-do.call(rbind,lapply(files81,read.csv,stringsAsFactors= TRUE))
files91<-list.files(paste(c(patha,pathj1),collapse = ""),pattern = patterna,full.names=TRUE)
sim91<-do.call(rbind,lapply(files91,read.csv,stringsAsFactors= TRUE))
files72<-list.files(paste(c(patha,pathh2),collapse = ""),pattern = patterna,full.names=TRUE)
sim72<-do.call(rbind,lapply(files72,read.csv,stringsAsFactors= TRUE))
files82<-list.files(paste(c(patha,pathi2),collapse = ""),pattern = patterna,full.names=TRUE)
sim82<-do.call(rbind,lapply(files82,read.csv,stringsAsFactors= TRUE))
files92<-list.files(paste(c(patha,pathj2),collapse = ""),pattern = patterna,full.names=TRUE)
sim92<-do.call(rbind,lapply(files92,read.csv,stringsAsFactors= TRUE))
plotfun2(dat1=sim2,dat2=sim5,dat3=sim8,enrollrate=0.1,delay=0,
path1="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/22_09_13/plot/final/roc_brar/diff_0_BRAR_tp_1_no_delayqq.pdf",
top1='Q-Q plot of Test Statistics Using BRAR with No Delay and tp=1 \nUnder the Null Hypothesis to Observe 0 Improvement')
plotfun2(dat1=sim3,dat2=sim6,dat3=sim9,enrollrate=0.1,delay=0,
path1="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/22_09_13/plot/final/roc_brar/diff_0_BRAR_tp_n_2N_no_delayqq.pdf",
top1='Q-Q plot of Test Statistics Using BRAR with No Delay and tp=n/2N \nUnder the Null Hypothesis to Observe 0 Improvement')
plotfun3(dat1=sim21,dat2=sim51,dat3=sim81,enrollrate=0.9,delay=30,
path1="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/22_09_13/plot/final/roc_brar/diff_0_BRAR_tp_1_1_month_delayqq0.9.pdf",
top1='Q-Q plot of Test Statistics Using BRAR with One Month Delay, tp=1 and ER=0.9 \nUnder the Null Hypothesis to Observe 0 Improvement')
plotfun3(dat1=sim31,dat2=sim61,dat3=sim91,enrollrate=0.9,delay=30,
path1="C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/22_09_13/plot/final/roc_brar/diff_0_BRAR_tp_n_2N_1_month_delayqq0.9.pdf",
top1='Q-Q plot of Test Statistics Using BRAR with One Month Delay, tp=n/2N and ER=0.9 \nUnder the Null Hypothesis to Observe 0 Improvement')
?lm
ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
weight <- c(ctl, trt)
lm.D9 <- lm(weight ~ group)
lm.D90 <- lm(weight ~ group - 1) # omitting intercept
lm.D90
setwd("C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/github/RARtrials")
require(devtools)
require(roxygen2)
document()
load_all()
require(devtools)
require(roxygen2)
document()
load_all()
build_vignettes()
build_vignettes()
setwd("C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/github/RARtrials")
require(devtools)
require(roxygen2)
document()
load_all()
build_vignettes()
install.packages(RARtrials)
install.packages('C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/github/RARtrials'')
install.packages('C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/github/RARtrials'')
install.packages('C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/github/RARtrials')
install.packages('C:/Users/cxu870/OneDrive - The University of Auckland/Desktop/github/RARtrials')
